

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Python API &mdash; rr 2.0.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Licensing" href="license.html" />
    <link rel="prev" title="Troubleshooting" href="troubleshooting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> rr
          

          
          </a>

          
            
            
              <div class="version">
                2.0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Python API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-rr.database">Database</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rr.database.load"><code class="docutils literal notranslate"><span class="pre">load()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rr.database.split_data"><code class="docutils literal notranslate"><span class="pre">split_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rr.database.get"><code class="docutils literal notranslate"><span class="pre">get()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-rr.preprocessor">Pre-processor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rr.preprocessor.estimate_norm"><code class="docutils literal notranslate"><span class="pre">estimate_norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rr.preprocessor.normalize"><code class="docutils literal notranslate"><span class="pre">normalize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-rr.algorithm">Machine Learning Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rr.algorithm.make_labels"><code class="docutils literal notranslate"><span class="pre">make_labels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#rr.algorithm.Machine"><code class="docutils literal notranslate"><span class="pre">Machine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rr.algorithm.Machine.predict"><code class="docutils literal notranslate"><span class="pre">Machine.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rr.algorithm.Machine.J"><code class="docutils literal notranslate"><span class="pre">Machine.J()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rr.algorithm.Machine.dJ"><code class="docutils literal notranslate"><span class="pre">Machine.dJ()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rr.algorithm.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rr.algorithm.Trainer.J"><code class="docutils literal notranslate"><span class="pre">Trainer.J()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rr.algorithm.Trainer.dJ"><code class="docutils literal notranslate"><span class="pre">Trainer.dJ()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#rr.algorithm.Trainer.train"><code class="docutils literal notranslate"><span class="pre">Trainer.train()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rr.algorithm.MultiClassMachine"><code class="docutils literal notranslate"><span class="pre">MultiClassMachine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rr.algorithm.MultiClassMachine.predict"><code class="docutils literal notranslate"><span class="pre">MultiClassMachine.predict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#rr.algorithm.MultiClassTrainer"><code class="docutils literal notranslate"><span class="pre">MultiClassTrainer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rr.algorithm.MultiClassTrainer.train"><code class="docutils literal notranslate"><span class="pre">MultiClassTrainer.train()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-rr.analysis">Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rr.analysis.CER"><code class="docutils literal notranslate"><span class="pre">CER()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#testing">Testing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Licensing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">rr</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Python API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="python-api">
<h1>Python API<a class="headerlink" href="#python-api" title="Permalink to this heading">¶</a></h1>
<section id="module-rr.database">
<span id="database"></span><h2>Database<a class="headerlink" href="#module-rr.database" title="Permalink to this heading">¶</a></h2>
<p>Database specifications for an evaluation protocol based on the Iris Flower
databases from Fisher’s original work.</p>
<dl class="py function">
<dt class="sig sig-object py" id="rr.database.load">
<span class="sig-prename descclassname"><span class="pre">rr.database.</span></span><span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/database.html#load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.database.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the data from its CSV format into an easy to dictionary of arrays</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rr.database.split_data">
<span class="sig-prename descclassname"><span class="pre">rr.database.</span></span><span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/database.html#split_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.database.split_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data for a given protocol</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rr.database.get">
<span class="sig-prename descclassname"><span class="pre">rr.database.</span></span><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">protocol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['setosa',</span> <span class="pre">'versicolor',</span> <span class="pre">'virginica']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['sepal</span> <span class="pre">length',</span> <span class="pre">'sepal</span> <span class="pre">width',</span> <span class="pre">'petal</span> <span class="pre">length',</span> <span class="pre">'petal</span> <span class="pre">width']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/database.html#get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.database.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the data subset given a particular protocol</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>protocol</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – one of the valid protocols supported by this interface</p></li>
<li><p><strong>subset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – one of ‘train’ or ‘test’</p></li>
<li><p><strong>classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – a list of strings containing the names of the classes from which you
want to have the data from</p></li>
<li><p><strong>variables</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – a list of strings containg the names of the variables (features) you
want to have data from</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – The data for all the classes and variables nicely packed into one numpy
3D array. One depth represents the data for one class, one row is one
example, one column a given feature.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-rr.preprocessor">
<span id="pre-processor"></span><h2>Pre-processor<a class="headerlink" href="#module-rr.preprocessor" title="Permalink to this heading">¶</a></h2>
<p>A simple pre-processing that applies Z-normalization to the input
features</p>
<dl class="py function">
<dt class="sig sig-object py" id="rr.preprocessor.estimate_norm">
<span class="sig-prename descclassname"><span class="pre">rr.preprocessor.</span></span><span class="sig-name descname"><span class="pre">estimate_norm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/preprocessor.html#estimate_norm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.preprocessor.estimate_norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the mean and standard deviation from a data set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – A 2D numpy ndarray in which the rows represent examples while the
columns, features of the data you want to estimate normalization
parameters on</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mean</strong> (<em>numpy.ndarray</em>) – A 1D numpy ndarray containing the estimated mean over
dimension 1 (columns) of the input data X</p></li>
<li><p><strong>std</strong> (<em>numpy.ndarray</em>) – A 1D numpy ndarray containing the estimated unbiased standard deviation
over dimension 1 (columns) of the input data X</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rr.preprocessor.normalize">
<span class="sig-prename descclassname"><span class="pre">rr.preprocessor.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/preprocessor.html#normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.preprocessor.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the given norm to the input data set</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – A 3D numpy ndarray in which the rows represent examples while the
columns, features of the data set you want to normalize. Every depth
corresponds to data for a particular class</p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a>) – A tuple containing two 1D numpy ndarrays corresponding to the
normalization parameters extracted with <code class="xref py py-func docutils literal notranslate"><span class="pre">estimated_norm()</span></code>
above.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X_normed</strong> – A 3D numpy ndarray with the same dimensions as the input array <code class="docutils literal notranslate"><span class="pre">X</span></code>,
but with its values normalized according to the norm input.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-rr.algorithm">
<span id="machine-learning-algorithm"></span><h2>Machine Learning Algorithm<a class="headerlink" href="#module-rr.algorithm" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="rr.algorithm.make_labels">
<span class="sig-prename descclassname"><span class="pre">rr.algorithm.</span></span><span class="sig-name descname"><span class="pre">make_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#make_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.make_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that generates a single 1D array with labels which
are good targets for stock logistic regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – The input data matrix. This must be an array with 3 dimensions or an
iterable containing 2 arrays with 2 dimensions each. Each correspond to
the data for one of the two classes, every row corresponds to one
example of the data set, every column, one different feature.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>labels</strong> – With a single dimension, containing suitable labels for all rows and
for all classes defined in X (depth).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rr.algorithm.Machine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rr.algorithm.</span></span><span class="sig-name descname"><span class="pre">Machine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#Machine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.Machine" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to handle all run-time aspects for Logistic Regression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>theta</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – A set of parameters for the Logistic Regression model. This must be an
iterable (or numpy array) with all parameters for the model, including
the bias term, which must be on entry 0 (the first entry at the
iterable).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rr.algorithm.Machine.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#Machine.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.Machine.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts the class of each row of X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – The input data matrix. This must be an array with 2 dimensions.
Every row corresponds to one example of the data set, every column,
one different feature.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – A 1D array with as many entries as rows in the input 2D array
<code class="docutils literal notranslate"><span class="pre">X</span></code>, representing g(x), the class predictions for the current
machine.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rr.algorithm.Machine.J">
<span class="sig-name descname"><span class="pre">J</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#Machine.J"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.Machine.J" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the logistic regression cost</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – The input data matrix. This must be an array with 3 dimensions or an
iterable containing 2 numpy.ndarrays with 2 dimensions each. Each
correspond to the data for one of the two classes, every row
corresponds to one example of the data set, every column, one
different feature.</p></li>
<li><p><strong>regularizer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The regularization parameter</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cost</strong> – The averaged (regularized) cost for the whole dataset</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rr.algorithm.Machine.dJ">
<span class="sig-name descname"><span class="pre">dJ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#Machine.dJ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.Machine.dJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the logistic regression first derivative of the cost w.r.t.
each parameter theta</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – The input data matrix. This must be an array with 3 dimensions or
an iterable containing 2 arrays with 2 dimensions each. Each
correspond to the data for one of the two classes, every row
corresponds to one example of the data set, every column, one
different feature.</p></li>
<li><p><strong>regularizer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The regularization parameter, if the solution should be regularized.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>grad</strong> – A 1D array with as many entries as columns on the input matrix
<code class="docutils literal notranslate"><span class="pre">X</span></code> plus 1 (the bias term). It denotes the average gradient of
the cost w.r.t. to each machine parameter theta.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rr.algorithm.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rr.algorithm.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regularizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to handle all training aspects for Logistic Regression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>regularizer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The regularization parameter</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rr.algorithm.Trainer.J">
<span class="sig-name descname"><span class="pre">J</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#Trainer.J"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.Trainer.J" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the vectorized cost <em>J</em>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rr.algorithm.Trainer.dJ">
<span class="sig-name descname"><span class="pre">dJ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">machine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#Trainer.dJ"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.Trainer.dJ" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the vectorized partial derivative of the cost <em>J</em> w.r.t. to
<strong>all</strong> :math:` heta`’s. Use the training dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rr.algorithm.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#Trainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.Trainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimizes the machine parameters to fit the input data, using
<code class="docutils literal notranslate"><span class="pre">scipy.optimize.fmin_l_bfgs_b</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – The input data matrix. This must be an array with 3 dimensions or
an iterable containing 2 arrays with 2 dimensions each.  Each
correspond to the data for one of the two classes, every row
corresponds to one example of the data set, every column, one
different feature.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>machine</strong> – A trained machine.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rr.algorithm.Machine" title="rr.algorithm.Machine">Machine</a></p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.11)"><strong>RuntimeError</strong></a> – In case problems exist with the design matrix <code class="docutils literal notranslate"><span class="pre">X</span></code> or with
    convergence.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rr.algorithm.MultiClassMachine">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rr.algorithm.</span></span><span class="sig-name descname"><span class="pre">MultiClassMachine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">machines</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#MultiClassMachine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.MultiClassMachine" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to handle all run-time aspects for Multiclass Log. Regression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>machines</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>) – An iterable over any number of machines that will be stored.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rr.algorithm.MultiClassMachine.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#MultiClassMachine.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.MultiClassMachine.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts the class of each row of X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – The input data matrix. This must be an array with 3 dimensions or
an iterable containing 2 arrays with 2 dimensions each.  Each
correspond to the data for one of the two classes, every row
corresponds to one example of the data set, every column, one
different feature.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predictions</strong> – A 1D array with as many entries as rows in the input 2D array
<code class="docutils literal notranslate"><span class="pre">X</span></code>, representing g(x), the class predictions for the current
machine.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rr.algorithm.MultiClassTrainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rr.algorithm.</span></span><span class="sig-name descname"><span class="pre">MultiClassTrainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regularizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#MultiClassTrainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.MultiClassTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>A class to handle all training aspects for Multiclass Log. Regression</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>regularizer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – The regularization parameter</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rr.algorithm.MultiClassTrainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/algorithm.html#MultiClassTrainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.algorithm.MultiClassTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains multiple logistic regression classifiers to handle the multiclass
problem posed by <code class="docutils literal notranslate"><span class="pre">X</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><em>numpy.ndarray</em></a>) – The input data matrix. This must be an array with 3 dimensions or
an iterable containing 2 arrays with 2 dimensions each.  Each
correspond to the data for one of the input classes, every row
corresponds to one example of the data set, every column, one
different feature.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>machine</strong> – A trained multiclass machine.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#rr.algorithm.Machine" title="rr.algorithm.Machine">Machine</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-rr.analysis">
<span id="analysis"></span><h2>Analysis<a class="headerlink" href="#module-rr.analysis" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="rr.analysis.CER">
<span class="sig-prename descclassname"><span class="pre">rr.analysis.</span></span><span class="sig-name descname"><span class="pre">CER</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_labels</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/rr/analysis.html#CER"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rr.analysis.CER" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the classification error rate for an N-class classification problem</p>
<p>Parameters:</p>
<dl class="simple">
<dt>prediction (numpy.ndarray): A 1D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> containing your</dt><dd><p>prediction</p>
</dd>
<dt>true_labels (numpy.ndarray): A 1D <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.24)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></dt><dd><p>containing the ground truth labels for the input array, organized in the
same order.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="testing">
<h2>Testing<a class="headerlink" href="#testing" title="Permalink to this heading">¶</a></h2>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="license.html" class="btn btn-neutral float-right" title="Licensing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="troubleshooting.html" class="btn btn-neutral float-left" title="Troubleshooting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2023, Idiap Research Institute.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>